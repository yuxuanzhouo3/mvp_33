# Supabase 邮箱确认设置

## 问题：新注册用户出现 "Unauthorized" 错误

如果新注册的用户在搜索或添加联系人时遇到 "Unauthorized" 错误，可能是因为 Supabase 启用了邮箱确认功能。

## 解决方案

### 方法 1：禁用邮箱确认（推荐用于开发环境）

1. 登录 [Supabase Dashboard](https://supabase.com/dashboard)
2. 选择项目：`communication_tool`
3. 进入 **Authentication** > **Settings**
4. 找到 **Email Auth** 部分
5. 取消勾选 **"Enable email confirmations"**
6. 保存设置

这样新注册的用户可以立即使用，无需确认邮箱。

### 方法 2：保持邮箱确认启用

如果保持邮箱确认启用：
1. 用户注册后会收到确认邮件
2. 用户需要点击邮件中的链接确认邮箱
3. 确认后才能正常使用所有功能

## 当前实现

应用已添加自动处理：
- 注册后如果没有会话，会自动尝试登录一次来建立会话
- 如果仍然失败，会提示用户可能需要确认邮箱

## 测试建议

对于开发环境，建议：
1. 禁用邮箱确认（方法 1）
2. 这样新注册的用户可以立即使用所有功能
3. 生产环境可以根据需要启用邮箱确认

